[
  {
    "title": "Refactor tools/context-manager.sh to use jq instead of sed",
    "body": "## Description\nRewrite `tools/context-manager.sh` to eliminate sed/awk usage and use jq for JSON manipulation. Replace hardcoded paths with SKOGAI_* environment variables.\n\n## Current Issues\n- Uses `sed -i` extensively for JSON field updates (lines 13-16, 41-42)\n- Hardcoded paths: `/home/skogix/skogai/context/`\n- Brittle string replacement for JSON manipulation\n\n## Requirements\n- Replace all `sed` commands with `jq` for JSON manipulation\n- Use `SKOGAI_HOME` environment variable with sane defaults\n- Use `SKOGAI_CONTEXT_DIR` for context directory paths\n- Maintain exact same functionality\n- Ensure proper error handling\n\n## Example Transformation\n**Before:**\n```bash\nsed -i \"s/\\\"created\\\": \\\"\\\"/\\\"created\\\": \\\"\\$(date -Iseconds)\\\"/\" \"/home/skogix/skogai/context/current/context-\\${session_id}.json\"\n```\n\n**After:**\n```bash\nCONTEXT_DIR=\"\\${SKOGAI_CONTEXT_DIR:-\\${SKOGAI_HOME:-\\$HOME/skogai}/context}\"\njq \".created = \\\"\\$(date -Iseconds)\\\"\" \"\\${CONTEXT_DIR}/current/context-\\${session_id}.json\" > tmp.json && mv tmp.json \"\\${CONTEXT_DIR}/current/context-\\${session_id}.json\"\n```\n\n## Environment Variables to Use\n- `SKOGAI_HOME` - Base directory (default: `\\$HOME/skogai` or `\\$(pwd)`)\n- `SKOGAI_CONTEXT_DIR` - Context directory (default: `\\$SKOGAI_HOME/context`)\n\n## Testing\n- Verify all functions work: create, archive, update\n- Test with and without environment variables set\n- Ensure JSON output is valid\n\nRelated to #41",
    "labels": ["refactoring", "shell-scripts", "environment-variables"]
  }
]
